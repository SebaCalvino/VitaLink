@{
    ViewData["Title"] = "Calendario";
    var encuentros = ViewBag.Encuentros as List<dynamic> ?? new List<dynamic>();
}

<main class="Calendario-App">
    <section class="Calendario-Panel">
        <header class="Calendario-Header">
            <div class="Calendario-Titulo">
                <h2>Calendario</h2>
                <div class="Calendario-MesActual"></div>
            </div>
            <div class="Calendario-Navegacion">
                <button class="Cal-BtnPrev" type="button" aria-label="Mes anterior">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                </button>
                <button class="Cal-BtnNext" type="button" aria-label="Mes siguiente">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </button>
            </div>
        </header>


        <div class="Calendario-Card">
            <div class="Calendario-Semanas">
                <span>LUN</span>
                <span>MAR</span>
                <span>MIÉ</span>
                <span>JUE</span>
                <span>VIE</span>
                <span>SÁB</span>
                <span>DOM</span>
            </div>
            <div class="Calendario-Dias" data-calendario-dias>

            </div>
        </div>


        <div class="Calendario-Acciones">
            <button class="btn-calendario" type="button" data-action="agregar-turno">
                Agregar Turno
            </button>
            <button class="btn-calendario secundario" type="button" data-action="cargar-medicamento">
                Cargar Medicamento
            </button>
        </div>
    </section>

    <!-- Modal/Pestaña para mostrar eventos del día -->
    <div class="Detalle-Evento" data-calendario-detalle hidden>
        <div class="Detalle-Contenido">
            <button class="Detalle-Cerrar" type="button" aria-label="Cerrar">×</button>
            <div class="Detalle-Fecha"></div>
            <div class="Detalle-Titulo">Turno medico</div>
            <div class="Detalle-Info">
                <div class="Detalle-Item">
                    <strong>Dirección:</strong>
                    <span data-detalle-direccion></span>
                </div>
                <div class="Detalle-Item">
                    <strong>Hora:</strong>
                    <span data-detalle-hora></span>
                </div>
                <div class="Detalle-Item">
                    <strong>Descripción:</strong>
                    <span data-detalle-descripcion></span>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    window.calendarioEventos = @Html.Raw(Json.Serialize(encuentros.Select(e => new {
        id = (int)e.Id,
        fecha = ((DateTime)e.FechaInicio).ToString("yyyy-MM-ddTHH:mm:ss"),
        nombreMedico = (string)(e.NombreMedico ?? ""),
        apellidoMedico = (string)(e.ApellidoMedico ?? ""),
        nombreOrganizacion = (string)(e.NombreOrganizacion ?? ""),
        direccion = (string)(e.Direccion ?? ""),
        descripcion = (string)(e.EstadoMotivo ?? "")
    })));
</script>
